Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
130
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
260
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
362
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
Not transmitting history with null moves to UCI engine
joblib.externals.loky.process_executor._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/scratch/work/selkeea1/.conda_envs/environment/lib/python3.14/site-packages/joblib/externals/loky/process_executor.py", line 490, in _process_worker
    r = call_item()
  File "/scratch/work/selkeea1/.conda_envs/environment/lib/python3.14/site-packages/joblib/externals/loky/process_executor.py", line 291, in __call__
    return self.fn(*self.args, **self.kwargs)
           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/work/selkeea1/.conda_envs/environment/lib/python3.14/site-packages/joblib/parallel.py", line 607, in __call__
    return [func(*args, **kwargs) for func, args, kwargs in self.items]
            ~~~~^^^^^^^^^^^^^^^^^
  File "/scratch/work/selkeea1/Generating-open-source-chess-puzzles/src/initialize_replay_buffer_with_lichess.py", line 30, in process_batch
    puzzle = get_unique_puzzle_from_fen(row.Puzzle_FEN, engine)
  File "/scratch/work/selkeea1/Generating-open-source-chess-puzzles/src/metrics/themes.py", line 48, in get_unique_puzzle_from_fen
    solution = cook_advantage(deepcopy(game), board.turn, engine)
  File "/scratch/work/selkeea1/Generating-open-source-chess-puzzles/src/metrics/themes.py", line 171, in cook_advantage
    follow_up = cook_advantage(node.add_main_variation(pair.best.move), winner, engine)
  File "/scratch/work/selkeea1/Generating-open-source-chess-puzzles/src/metrics/themes.py", line 171, in cook_advantage
    follow_up = cook_advantage(node.add_main_variation(pair.best.move), winner, engine)
  File "/scratch/work/selkeea1/Generating-open-source-chess-puzzles/src/metrics/themes.py", line 171, in cook_advantage
    follow_up = cook_advantage(node.add_main_variation(pair.best.move), winner, engine)
  [Previous line repeated 6 more times]
  File "/scratch/work/selkeea1/Generating-open-source-chess-puzzles/src/metrics/themes.py", line 165, in cook_advantage
    pair = get_next_pair(node, winner, engine)
  File "/scratch/work/selkeea1/Generating-open-source-chess-puzzles/src/metrics/themes.py", line 126, in get_next_pair
    pair = get_next_move_pair(engine, node, winner, pair_limit)
  File "/scratch/work/selkeea1/Generating-open-source-chess-puzzles/src/metrics/util.py", line 163, in get_next_move_pair
    best = EngineMove(info[0]["pv"][0], info[0]["score"].pov(winner))
                      ~~~~~~~^^^^^^
KeyError: 'pv'
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/scratch/work/selkeea1/Generating-open-source-chess-puzzles/src/initialize_replay_buffer_with_lichess.py", line 48, in <module>
    parallel_results = Parallel(n_jobs=num_cores)(delayed(process_batch)(parallel_chunk) for parallel_chunk in chunks)
  File "/scratch/work/selkeea1/.conda_envs/environment/lib/python3.14/site-packages/joblib/parallel.py", line 2072, in __call__
    return output if self.return_generator else list(output)
                                                ~~~~^^^^^^^^
  File "/scratch/work/selkeea1/.conda_envs/environment/lib/python3.14/site-packages/joblib/parallel.py", line 1682, in _get_outputs
    yield from self._retrieve()
  File "/scratch/work/selkeea1/.conda_envs/environment/lib/python3.14/site-packages/joblib/parallel.py", line 1784, in _retrieve
    self._raise_error_fast()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/scratch/work/selkeea1/.conda_envs/environment/lib/python3.14/site-packages/joblib/parallel.py", line 1859, in _raise_error_fast
    error_job.get_result(self.timeout)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/scratch/work/selkeea1/.conda_envs/environment/lib/python3.14/site-packages/joblib/parallel.py", line 758, in get_result
    return self._return_or_raise()
           ~~~~~~~~~~~~~~~~~~~~~^^
  File "/scratch/work/selkeea1/.conda_envs/environment/lib/python3.14/site-packages/joblib/parallel.py", line 773, in _return_or_raise
    raise self._result
KeyError: 'pv'
srun: error: milan10: task 0: Exited with exit code 1
srun: Terminating StepId=15703967.0
